--- php-4.3.0/ext/standard/aggregation.c.orig	Thu Dec  5 13:44:21 2002
+++ php-4.3.0/ext/standard/aggregation.c	Fri Jan  3 10:31:35 2003
@@ -21,7 +21,7 @@
 #include "php.h"
 #include "basic_functions.h"
 #include "aggregation.h"
-#if HAVE_PCRE || HAVE_BUNDLED_PCRE
+#if (HAVE_PCRE || HAVE_BUNDLED_PCRE) && !defined(COMPILE_DL_PCRE)
 #include "ext/pcre/php_pcre.h"
 #endif
 
@@ -77,7 +77,7 @@
 	uint func_name_len;
 	ulong num_key;
 	zval *list_hash = NULL;
-#if HAVE_PCRE || HAVE_BUNDLED_PCRE
+#if (HAVE_PCRE || HAVE_BUNDLED_PCRE) && !defined(COMPILE_DL_PCRE)
 	pcre *re = NULL;
 	pcre_extra *re_extra = NULL;
 	int re_options = 0;
@@ -89,7 +89,7 @@
 	if (aggr_type == AGGREGATE_BY_LIST) {
 		list_hash = array_to_hash(aggr_filter);
 	}
-#if HAVE_PCRE || HAVE_BUNDLED_PCRE
+#if (HAVE_PCRE || HAVE_BUNDLED_PCRE) && !defined(COMPILE_DL_PCRE)
 	else if (aggr_type == AGGREGATE_BY_REGEXP) {
 		if ((re = pcre_get_compiled_regex(Z_STRVAL_P(aggr_filter), &re_extra, &re_options)) == NULL) {
 			return;
@@ -119,7 +119,7 @@
 				func_name[0] == '_' ||
 			/* 3. explicitly excluded methods */
 				(aggr_type == AGGREGATE_BY_LIST && zend_hash_exists(Z_ARRVAL_P(list_hash), func_name, func_name_len))
-#if HAVE_PCRE || HAVE_BUNDLED_PCRE
+#if (HAVE_PCRE || HAVE_BUNDLED_PCRE) && !defined(COMPILE_DL_PCRE)
 				||
 			/* 4. methods matching regexp as modified by the exclusion flag */
 				(aggr_type == AGGREGATE_BY_REGEXP && (pcre_exec(re, re_extra, func_name, func_name_len-1, 0, 0, NULL, 0) < 0) ^ exclude) == 1
@@ -178,7 +178,7 @@
 	uint prop_name_len;
 	ulong num_key;
 	zval *list_hash = NULL;
-#if HAVE_PCRE || HAVE_BUNDLED_PCRE
+#if (HAVE_PCRE || HAVE_BUNDLED_PCRE) && !defined(COMPILE_DL_PCRE)
 	pcre *re = NULL;
 	pcre_extra *re_extra = NULL;
 	int re_options = 0;
@@ -195,7 +195,7 @@
 	if (aggr_type == AGGREGATE_BY_LIST) {
 		list_hash = array_to_hash(aggr_filter);
 	}
-#if HAVE_PCRE || HAVE_BUNDLED_PCRE
+#if (HAVE_PCRE || HAVE_BUNDLED_PCRE) && !defined(COMPILE_DL_PCRE)
 	else if (aggr_type == AGGREGATE_BY_REGEXP) {
 		if ((re = pcre_get_compiled_regex(Z_STRVAL_P(aggr_filter), &re_extra, &re_options)) == NULL) {
 			return;
@@ -223,7 +223,7 @@
 			if (prop_name[0] == '_' ||
 			/* 2. explicitly excluded properties */
 				(aggr_type == AGGREGATE_BY_LIST && zend_hash_exists(Z_ARRVAL_P(list_hash), prop_name, prop_name_len))
-#if HAVE_PCRE || HAVE_BUNDLED_PCRE
+#if (HAVE_PCRE || HAVE_BUNDLED_PCRE) && !defined(COMPILE_DL_PCRE)
 				||
 			/* 3. properties matching regexp as modified by the exclusion flag */
 				(aggr_type == AGGREGATE_BY_REGEXP && (pcre_exec(re, re_extra, prop_name, prop_name_len-1, 0, 0, NULL, 0) < 0) ^ exclude) == 1
@@ -508,7 +508,7 @@
 }
 /* }}} */
 
-#if HAVE_PCRE || HAVE_BUNDLED_PCRE
+#if (HAVE_PCRE || HAVE_BUNDLED_PCRE) && !defined(COMPILE_DL_PCRE)
 /* {{{ proto void aggregate_methods_by_regexp(object obj, string class, string regexp [, bool exclude])
    */
 PHP_FUNCTION(aggregate_methods_by_regexp)
--- php-4.3.0/ext/standard/basic_functions.c.orig	Fri Dec 20 17:37:44 2002
+++ php-4.3.0/ext/standard/basic_functions.c	Fri Jan  3 10:42:33 2003
@@ -862,7 +862,7 @@
 	PHP_FE(aggregate_methods_by_list,		first_arg_force_ref)
 	PHP_FE(aggregate_properties,			first_arg_force_ref)
 	PHP_FE(aggregate_properties_by_list,	first_arg_force_ref)
-#if HAVE_PCRE || HAVE_BUNDLED_PCRE
+#if (HAVE_PCRE || HAVE_BUNDLED_PCRE) && !defined(COMPILE_DL_PCRE)
 	PHP_FE(aggregate_methods_by_regexp,		first_arg_force_ref)
 	PHP_FE(aggregate_properties_by_regexp,	first_arg_force_ref)
 #endif
